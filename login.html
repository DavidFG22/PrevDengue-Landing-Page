<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iniciar Sesión - PrevDengue</title>

    <link rel="stylesheet" href="login-style.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito+Sans:opsz,wght@6..12,300;400;600;700&family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="login-wrapper">
      <div class="login-card">
        <div class="card-header-nav">
          <a href="index.html" class="back-link">
            <i class="fa-solid fa-arrow-left"></i> Volver al inicio
          </a>
        </div>

        <div class="login-header">
          <img
            src="Imagenes/logo sin fondo.png"
            alt="Logo PrevDengue"
            class="login-logo-img"
          />

          <h2>Bienvenido de nuevo</h2>
          <p>Ingresa tus credenciales para continuar.</p>
        </div>

        <form class="login-form">
          <div class="input-group">
            <label for="user">Correo electrónico o celular</label>
            <div class="input-wrapper">
              <i class="fa-regular fa-envelope input-icon"></i>
              <input
                type="text"
                id="user"
                placeholder="ejemplo@correo.com"
                required
              />
            </div>
          </div>

          <div class="input-group">
            <label for="password">Contraseña</label>
            <div class="input-wrapper">
              <i class="fa-solid fa-lock input-icon"></i>
              <input
                type="password"
                id="password"
                placeholder="••••••••"
                required
              />
              <i class="fa-regular fa-eye toggle-password"></i>
            </div>
          </div>

          <div class="form-options">
            <label class="checkbox-container">
              <input type="checkbox" />
              <span class="checkmark"></span>
              Recordarme
            </label>
            <a href="#" class="forgot-password">¿Olvidaste tu contraseña?</a>
          </div>

          <button type="submit" class="btn-submit">Iniciar Sesión</button>
        </form>

        <div class="divider">
          <span>O continúa con</span>
        </div>

        <div class="social-login">
          <button class="btn-social google">
            <i class="fa-brands fa-google"></i> Google
          </button>
          <button class="btn-social facebook">
            <i class="fa-brands fa-facebook-f"></i> Facebook
          </button>
        </div>

        <div class="login-footer">
          <p>
            ¿Aún no tienes una cuenta?
            <a href="register.html">Regístrate aquí</a>
          </p>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const loginForm = document.querySelector(".login-form");
        const emailInput = document.getElementById("user");
        const passwordInput = document.getElementById("password");
        const togglePasswordIcon = document.querySelector(".toggle-password");

        // 1. Funcionalidad para mostrar/ocultar contraseña
        togglePasswordIcon.addEventListener("click", () => {
          const type =
            passwordInput.getAttribute("type") === "password"
              ? "text"
              : "password";
          passwordInput.setAttribute("type", type);
          
          // Cambiar icono
          togglePasswordIcon.classList.toggle("fa-eye");
          togglePasswordIcon.classList.toggle("fa-eye-slash");
        });

        // 2. Validación al enviar el formulario
        loginForm.addEventListener("submit", (e) => {
          e.preventDefault(); // Evita que la página se recargue

          const emailValue = emailInput.value.trim().toLowerCase();
          const passwordValue = passwordInput.value;

          // Dominios permitidos
          const allowedDomains = [
            "@gmail.com",
            "@hotmail.com",
            "@outlook.com",
            "@yahoo.com",
            "@icloud.com",
          ];

          // A. Validar Correo
          const isValidEmail = allowedDomains.some((domain) =>
            emailValue.endsWith(domain)
          );

          if (!isValidEmail) {
            alert("Por favor, usa un correo válido (ej: @gmail.com, @hotmail.com).");
            emailInput.style.borderColor = "#EF4444"; // Rojo error
            emailInput.focus();
            return;
          } else {
            emailInput.style.borderColor = "#E2E8F0"; // Restaurar borde
          }

          // B. Validar Contraseña (Mínimo 8 caracteres)
          if (passwordValue.length < 8) {
            alert("La contraseña debe tener al menos 8 caracteres.");
            passwordInput.style.borderColor = "#EF4444";
            passwordInput.focus();
            return;
          } else {
            passwordInput.style.borderColor = "#E2E8F0";
          }

          // C. SI TODO ESTÁ CORRECTO -> REDIRIGIR
          // Aquí ocurre la magia:
          window.location.href = "dashboard.html";
        });

        // Limpiar error cuando el usuario escribe
        emailInput.addEventListener("input", () => emailInput.style.borderColor = "#E2E8F0");
        passwordInput.addEventListener("input", () => passwordInput.style.borderColor = "#E2E8F0");
      });
    </script>
  </body>
</html>
